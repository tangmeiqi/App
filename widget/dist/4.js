webpackJsonp([4],{158:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=s(27),i=s.n(o),r=s(179),a=s.n(r);e.default={name:"Tbspecial",props:[],components:{tbspecialshop:a.a},data:function(){return{specialtitle:this.$route.query.item,type:2,listData:[],from:0,pageSize:15,page:1,scrolls:{pageScrollTop:0,scrollBottom:!1,height:0,pagingCount:1},query:{range:{zkFinalPrice:{lte:9.9}}},sort:[{zkFinalPrice:{order:"asc"}}],client:new i.a.Client({host:"47.97.153.221:9200"})}},computed:{size:function(){return this.pageSize*this.page}},methods:{back:function(){history.go(-1)},getdata:function(){this.specialtitle=this.$route.query.item},priceSort:function(){this.sort=[{zkFinalPrice:{order:"asc"}}],this.scrollBottomChanged(!0)},saleSort:function(){this.sort=[{volume:{order:"desc"}}],this.scrollBottomChanged(!0)},latestSort:function(){this.sort=[{createTime:{order:"desc"}}],this.scrollBottomChanged(!0)},popularitySort:function(){this.sort=[{_script:{script:"def popularity = doc['volume'].value * 0.8 + doc['couponRemainCount'].value * 0.2;return popularity",type:"number",order:"desc"}}],this.scrollBottomChanged(!0)},scrollBottomChanged:function(t){var e=this;this.type;switch(this.specialtitle){case"9.9特价":this.query={range:{zkFinalPrice:{lte:9.9}}};break;case"19.9包邮":this.query={range:{zkFinalPrice:{gt:9.9,lte:19.9}}};break;case"每日半价":this.query={bool:{must:{script:{script:{source:"doc['zkFinalPrice'].value * 2 <= doc['originalPrice'].value",lang:"painless"}}}}};break;case"天猫精选":this.query={term:{platform:1}};break;case"top100":this.query={match_all:{}}}this.client.search({index:"ssb",type:"good",body:{from:this.from,size:"top100"===this.specialtitle?100:this.size,query:this.query,sort:this.sort}}).then(function(t){e.listData=t.hits.hits},function(t){console.trace(t.message)})},scroll:function(t){var e=t.target.offsetHeight;t.target.scrollTop>=128*this.size-e&&(this.page++,this.scrollBottomChanged(!0))},initPage:function(){this.page=1}},watch:{$route:"getdata"},mounted:function(){document.getElementById("scrollElement").addEventListener("scroll",this.scroll)},beforeRouteEnter:function(t,e,s){s(function(t){t.getdata(),t.initPage(),t.scrollBottomChanged(!0)})}}},159:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"Tbspecialshop",props:["ownprop"],components:{},data:function(){return{}},methods:{linktoItem:function(){this.$root.eventHub.$emit("pushToDetail",this.ownprop),localStorage.tbitem=JSON.stringify(this.ownprop)}}}},179:function(t,e,s){s(!function(){var t=new Error('Cannot find module "!!../../../node_modules/extract-text-webpack-plugin/loader.js?{"omit":1,"remove":true}!vue-style-loader!css-loader?{"minimize":true,"sourceMap":true}!../../../node_modules/vue-loader/lib/style-rewriter?id=data-v-5198d0aa&scoped=true!sass-loader?{"sourceMap":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Tbspecialshop.vue"');throw t.code="MODULE_NOT_FOUND",t}());var o=s(6)(s(159),s(195),"data-v-5198d0aa",null);t.exports=o.exports},191:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"slide-up"}},[s("div",{staticClass:"speciallist"},[s("div",{staticClass:"top"},[s("div",{staticClass:"back",on:{click:t.back}}),t._v(" "),s("div",{staticClass:"text"},[t._v(t._s(t.specialtitle))])]),t._v(" "),s("div",{staticClass:"listview_header"},[s("span",[t._v("排序")]),t._v(" "),s("button",{on:{click:t.popularitySort}},[t._v("人气")]),t._v(" "),s("button",{on:{click:t.latestSort}},[t._v("最新")]),t._v(" "),s("button",{on:{click:t.saleSort}},[t._v("销量")]),t._v(" "),s("button",{on:{click:t.priceSort}},[t._v("价格")])]),t._v(" "),s("div",{staticClass:"listview-content",attrs:{id:"scrollElement"}},t._l(t.listData,function(t,e){return s("tbspecialshop",{key:e,tag:"ul",attrs:{ownprop:t}})}))])])},staticRenderFns:[]}},195:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop"},[s("div",{staticClass:"shop-box",on:{click:t.linktoItem}},[s("img",{staticClass:"shop-avt",attrs:{src:t.ownprop._source.picUrl}}),t._v(" "),s("div",{staticClass:"shop-info"},[s("div",{staticClass:"shop-name"},[t._v(t._s(t.ownprop._source.title))]),t._v(" "),s("div",{staticClass:"shop-assess"},[s("div",{staticClass:"shop-assess-row row1"},[s("span",{staticClass:"price"},[t._v("￥"+t._s(t.ownprop._source.zkFinalPrice)),s("span",{staticClass:"pricetext"},[t._v(" 折后价")])])]),t._v(" "),s("div",{staticClass:"shop-assess-row row2"},[s("span",{staticClass:"sale"},[t._v("销量 ")]),s("span",{staticClass:"sale"},[t._v(t._s(t.ownprop._source.volume))])])])])])])},staticRenderFns:[]}},92:function(t,e,s){s(!function(){var t=new Error('Cannot find module "!!../../../node_modules/extract-text-webpack-plugin/loader.js?{"omit":1,"remove":true}!vue-style-loader!css-loader?{"minimize":true,"sourceMap":true}!../../../node_modules/vue-loader/lib/style-rewriter?id=data-v-45893e35&scoped=true!sass-loader?{"sourceMap":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Tbspecial.vue"');throw t.code="MODULE_NOT_FOUND",t}());var o=s(6)(s(158),s(191),"data-v-45893e35",null);t.exports=o.exports}});